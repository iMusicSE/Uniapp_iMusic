# 网易云音乐搜索下载器 - v2.0 更新说明

## 🎉 主要更新内容

### ✨ 新增功能

#### 1. 歌词下载功能
本次更新最重要的功能是**自动下载歌词**，支持以下特性：

- **LRC格式歌词**（带时间轴）
  - 完整保留原始时间戳信息
  - 可在支持LRC的播放器中同步显示
  - 格式：`[00:00.00]歌词内容`

- **TXT格式歌词**（纯文本）
  - 移除时间戳，纯文本格式
  - 方便阅读和复制
  - 包含歌曲和歌手信息头部

- **双语歌词支持**
  - 自动检测是否有翻译版本
  - 如果有翻译，会额外生成双语TXT文件
  - 原文和翻译分别展示

#### 2. 歌词下载选项
- 在界面上添加了**"同时下载歌词（LRC + TXT）"**复选框
- 位置：下载按钮上方
- 默认状态：已勾选（推荐）
- 可以随时切换是否下载歌词

#### 3. 智能文件管理
- 歌词文件自动保存到与音乐文件相同的目录
- 使用统一的文件命名规则：
  ```
  歌曲名 - 歌手.mp3    # 音乐文件
  歌曲名 - 歌手.lrc    # LRC歌词
  歌曲名 - 歌手.txt    # TXT歌词
  歌曲名 - 歌手_双语.txt  # 双语歌词（如果有）
  ```

### 🔄 改进内容

#### 1. 下载流程优化
- 先下载音乐文件，再下载歌词
- 实时显示下载状态
- 状态栏提示更加详细：
  - "正在下载音乐: XXX"
  - "音乐下载进度: XX.X%"
  - "正在下载歌词..."
  - "下载完成"

#### 2. 提示信息增强
下载完成后的提示框会显示：
- 音乐文件保存位置
- 歌词文件数量（如果下载了歌词）
- 歌词格式说明（LRC、TXT、双语版本）
- 如果歌曲没有歌词，会显示相应提示但不影响音乐下载

#### 3. 错误处理改进
- 如果歌曲没有歌词，会提示"该歌曲暂无歌词"
- 歌词下载失败不影响音乐文件的正常使用
- 显示详细的错误信息，方便排查问题

### 📊 技术改进

#### 新增API调用
```python
URL: http://music.163.com/api/song/lyric
参数:
  - id: 歌曲ID
  - lv: -1 (原文歌词)
  - kv: -1 (卡拉OK版本)
  - tv: -1 (翻译版本)
```

#### 新增方法
- `get_lyrics(song_id)` - 获取歌词数据
- `parse_lrc_to_text(lrc_content)` - LRC转TXT格式
- `save_lyrics_files(...)` - 保存歌词文件
- `download_lyrics(...)` - 完整的歌词下载流程

#### 代码优化
- 添加正则表达式处理（`import re`）
- 改进文件路径处理
- 增强异常处理机制

## 📖 使用方法

### 基本使用
1. **启动程序**：双击`启动程序.bat`或运行`python music_search_ui.py`
2. **搜索歌曲**：输入歌曲名称，点击搜索
3. **选择歌曲**：在结果列表中选择要下载的歌曲
4. **选择是否下载歌词**：勾选或取消"同时下载歌词（LRC + TXT）"
5. **开始下载**：点击下载按钮或双击歌曲
6. **选择保存位置**：在弹出的对话框中选择保存目录和文件名
7. **等待完成**：查看状态栏了解下载进度

### 高级使用

#### 使用LRC歌词
1. 下载音乐和歌词后，将它们放在同一目录
2. 使用支持LRC的播放器打开音乐文件
3. 播放器会自动加载同名的LRC文件
4. 推荐播放器：
   - Foobar2000
   - 网易云音乐客户端
   - Potplayer
   - MusicBee

#### 阅读TXT歌词
- 直接用记事本或其他文本编辑器打开
- 推荐使用UTF-8编码的编辑器
- 如果显示乱码，检查编辑器的编码设置

## 🐛 已知问题

### 1. 部分歌曲无歌词
- **原因**：纯音乐、老歌、小众歌曲可能没有歌词数据
- **影响**：不影响音乐下载，只是无法保存歌词文件
- **解决**：这是正常现象，无需处理

### 2. 歌词时间轴偏移
- **原因**：网易云音乐的歌词时间轴可能与实际音频略有差异
- **影响**：播放时歌词显示可能提前或延后
- **解决**：使用播放器的歌词同步调节功能

### 3. 文件编码问题
- **原因**：歌词使用UTF-8编码保存
- **影响**：部分旧版编辑器可能显示乱码
- **解决**：使用支持UTF-8的现代文本编辑器

## ⚠️ 注意事项

1. **网络要求**
   - 下载歌词需要访问网易云音乐API
   - 确保网络连接稳定

2. **文件命名**
   - 歌词文件名必须与音乐文件名一致（扩展名除外）
   - 程序会自动处理，无需手动调整

3. **版权说明**
   - 本程序仅供学习研究使用
   - 请遵守相关法律法规
   - 不得用于商业目的

4. **播放器兼容性**
   - LRC文件采用标准格式
   - 大多数主流播放器都支持
   - 如果播放器不支持，可以使用TXT版本

## 🔜 未来计划

### 可能的功能改进
- [ ] 批量下载功能
- [ ] 歌词翻译语言选择
- [ ] 自定义歌词文件名格式
- [ ] 歌词编辑功能
- [ ] 专辑封面下载
- [ ] 播放列表管理

### 欢迎反馈
如果你有任何建议或需求，欢迎反馈！

## 📦 文件说明

更新后的文件列表：
```
UI界面/
  ├── music_search_ui.py          # 主程序（已更新）
  ├── 启动程序.bat                 # 启动脚本
  ├── requirements.txt            # 依赖列表
  ├── 使用指南.md                  # 详细使用说明（已更新）
  ├── 更新说明_v2.0.md            # 本文件
  └── README.md                   # 项目说明
```

## 🚀 快速开始

如果这是你第一次使用，请按以下步骤操作：

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **启动程序**
   - Windows：双击`启动程序.bat`
   - 命令行：`python music_search_ui.py`

3. **开始使用**
   - 搜索歌曲
   - 勾选歌词下载选项（默认已勾选）
   - 下载并享受音乐和歌词！

## 💡 使用技巧

1. **默认启用歌词下载**
   - 歌词下载选项默认勾选
   - 如果不需要歌词，可以取消勾选

2. **文件整理**
   - 建议为不同类型的音乐创建不同的文件夹
   - 歌词文件会自动保存在音乐文件旁边

3. **播放器设置**
   - 确保播放器启用了LRC歌词支持
   - 检查播放器的歌词文件路径设置

4. **歌词阅读**
   - TXT格式方便在手机或电脑上阅读
   - 双语版本适合学习外语歌曲

---

**感谢使用！享受你的音乐之旅！🎵**

版本：v2.0  
更新日期：2024年

